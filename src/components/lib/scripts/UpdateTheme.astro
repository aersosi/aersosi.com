<script>
	function updateTheme(isDark) {
		document.documentElement.classList.toggle("dark", isDark);
		document.documentElement.classList.toggle("light", !isDark);
		localStorage.setItem("theme", isDark ? "dark" : "light");

		// Update all theme toggles
		document.querySelectorAll("[data-theme-toggle]").forEach((button) => {
			button.setAttribute("aria-checked", isDark ? "true" : "false");
		});
	}

	function initializeTheme() {
		const savedTheme = localStorage.getItem("theme");
		const systemPrefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
		const isDark = savedTheme ? savedTheme === "dark" : systemPrefersDark;
		updateTheme(isDark);
	}

	initializeTheme();

	// Attach event listener to all theme toggles
	document.querySelectorAll("[data-theme-toggle]").forEach((button) => {
		button.addEventListener("click", () => {
			const isDark = document.documentElement.classList.contains("dark");
			updateTheme(!isDark);
		});
	});
</script>
