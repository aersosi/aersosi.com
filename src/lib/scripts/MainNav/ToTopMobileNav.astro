<script>
  document.addEventListener("DOMContentLoaded", () => {
    const mobileNavBtn = document.getElementById("mobileNavBtn");
    const toTopBtn = document.getElementById("toTopBtn");
    const SCROLL_THRESHOLD = 320;
    const MIN_SCROLL_DISTANCE = 24;
    let lastScrollY = window.scrollY;

    if (!mobileNavBtn && !toTopBtn) return;

    let isResizing = false;

    const switchButtons = () => {
      if (isResizing) return;

      const currentScrollY = window.scrollY;
      const isOverThreshold = currentScrollY > SCROLL_THRESHOLD;
      const isScrollingDown = currentScrollY > lastScrollY;
      const scrollDistance = Math.abs(currentScrollY - lastScrollY);

      if (isOverThreshold) {
        if (!isScrollingDown && scrollDistance >= MIN_SCROLL_DISTANCE) {
          if (mobileNavBtn) mobileNavBtn.classList.remove("hidden");
          if (toTopBtn) toTopBtn.classList.add("hidden");
        } else if (isScrollingDown) {
          if (mobileNavBtn) mobileNavBtn.classList.add("hidden");
          if (toTopBtn) toTopBtn.classList.remove("hidden");
        }
      } else {
        if (mobileNavBtn) mobileNavBtn.classList.remove("hidden");
        if (toTopBtn) toTopBtn.classList.add("hidden");
      }

      lastScrollY = currentScrollY;
    };

    const scrollToTop = () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
    };

    switchButtons();

    window.addEventListener("resize", () => {
      isResizing = true;
      setTimeout(() => {
        isResizing = false;
      }, 1000);
    });

    window.addEventListener("scroll", switchButtons);

    if (toTopBtn) toTopBtn.addEventListener("click", scrollToTop);
  });
</script>
